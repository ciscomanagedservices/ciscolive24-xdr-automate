{
  "workflow": {
    "unique_name": "definition_workflow_02DIUZE85QAXE1Xes1tBKwjNjfz1ewzyOwN",
    "name": "Tool - Request Change Approval",
    "title": "Tool - Request Change Approval",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Request has been approved.",
          "scope": "output",
          "name": "o_message_content",
          "type": "datatype.string",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DIV23SEUA186nysrdAT95Z6wkE3dEhw7Q",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "i_approval_request_text",
          "type": "datatype.string",
          "description": "Text that describes the type of approval for change being made. Include as much technical detail as possible such as type of change and reason for change. Use markdown format.",
          "is_required": true,
          "display_on_wizard": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_02DIV1RVW4O8U33dKawLCGqjCTa2aWyot3s",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "Requests approval to execute changes on Secure Endpoint such as isolation.",
      "display_name": "Tool - Request Change Approval",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_02DIUZELIJMMM2GP15Nbid3dXNFDcoXL7c0",
        "name": "Create Approval Request",
        "title": "Create Approval Request",
        "type": "task.approval_request",
        "base_type": "activity",
        "properties": {
          "approval_choices": [
            "Approve",
            "Reject"
          ],
          "assignees": [
            "scdozier@cisco.com"
          ],
          "continue_on_failure": false,
          "display_name": "Create Approval Request",
          "due_date": {
            "is_relative_time": true,
            "is_specified_date": false,
            "relative_time": {
              "duration": 4,
              "time_units": "hours"
            },
            "set_due_date": true
          },
          "expiration_date": {
            "is_relative_time": true,
            "is_specified_date": false,
            "relative_time": {
              "duration": 12,
              "time_units": "hours"
            }
          },
          "expiration_status": "Expired",
          "minimum_approvals": 1,
          "priority": "high",
          "skip_execution": false,
          "subject_line": "XDR AI Agent Approval Request",
          "task_message": "Requesting appoval for change:\n-----\n$workflow.definition_workflow_02DIUZE85QAXE1Xes1tBKwjNjfz1ewzyOwN.input.variable_workflow_02DIV1RVW4O8U33dKawLCGqjCTa2aWyot3s$",
          "task_owner": "scdozier@cisco.com",
          "task_requestor": "scdozier@cisco.com"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02DIUZEQ4N6KC18834ogr6rwMHaLehBOUh6",
        "name": "Wait For Event",
        "title": "Wait for Approval",
        "type": "task.wait_for_event",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Wait for Approval",
          "event_info": {
            "add_event": true,
            "event_definition": {
              "conditions": {
                "left_operand": "$output.task_id$",
                "operator": "eq",
                "right_operand": "$activity.definition_activity_02DIUZELIJMMM2GP15Nbid3dXNFDcoXL7c0.output.task_id$"
              }
            }
          },
          "event_timeout": 2580000,
          "event_type": "approval_task.event",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_02DIUZERG4VDH7FyCRugohvFoAaJgBPgLkL",
        "name": "Condition Block",
        "title": "Was the request approved?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Was the request approved?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02DIUZESKAV6A4xu6k8LozsXefvIa5J0a1M",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_02DIUZEQ4N6KC18834ogr6rwMHaLehBOUh6.output.response$",
                "operator": "eqi",
                "right_operand": "Reject"
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DIWOWNR4B1D67dSlQhphg7GV9PNfqyvtK",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_02DIUZE85QAXE1Xes1tBKwjNjfz1ewzyOwN.output.variable_workflow_02DIV23SEUA186nysrdAT95Z6wkE3dEhw7Q$",
                      "variable_value_new": "Request was NOT approved."
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_025W2J2HK90LP3gVw454IoXQ0Qd1anzcY85",
      "category_02DEF0IUE5ZGA1PNJIWf3PYyD9AoM3jr4Si"
    ]
  },
  "categories": {
    "category_025W2J2HK90LP3gVw454IoXQ0Qd1anzcY85": {
      "unique_name": "category_025W2J2HK90LP3gVw454IoXQ0Qd1anzcY85",
      "name": "CLUS24",
      "title": "CLUS24",
      "type": "basic.category",
      "base_type": "category",
      "description": "Workflows \u0026 Atomic Actions for Cisco Live 2024 Session BRKATO-1557: Automating Detection \u0026 Response Outcomes using Cisco XDR and Generative AI",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_02DEF0IUE5ZGA1PNJIWf3PYyD9AoM3jr4Si": {
      "unique_name": "category_02DEF0IUE5ZGA1PNJIWf3PYyD9AoM3jr4Si",
      "name": "XDR_AI_Agent_Tool",
      "title": "XDR_AI_Agent_Tool",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  }
}